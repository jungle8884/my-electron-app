<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AIC8800-SDIO口测试</title>
  <!-- 引入Vue -->
  <script src="./js/vue.js"></script>
  <!-- 引入Element UI CSS -->
  <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
  <!-- 引入自定义CSS -->
  <link rel="stylesheet" href="./styles.css">
  <!-- 引入Element UI JS -->
  <script src="https://unpkg.com/element-ui/lib/index.js"></script>
</head>
<body>
  <div id="app">
    <el-container style="height: 100vh; border: 1px solid #eee;">
      <!-- 侧边栏 -->
      <el-aside width="200px" style="background-color: rgb(238, 241, 246);">
        <el-menu
          default-active="1"
          class="el-menu-vertical-demo"
          @select="handleMenuSelect"
        >
          <el-menu-item index="1">
            <i class="el-icon-info"></i>
            <span slot="title">配置信息</span>
          </el-menu-item>
          <el-menu-item index="2">
            <i class="el-icon-download"></i>
            <span slot="title">下载固件</span>
          </el-menu-item>
          <el-menu-item index="3">
            <i class="el-icon-check"></i>
            <span slot="title">SDIO测试</span>
          </el-menu-item>
          <el-menu-item index="4">
            <i class="el-icon-refresh"></i>
            <span slot="title">重置</span>
          </el-menu-item>
        </el-menu>
      </el-aside>
      
      <el-container>
        <!-- 顶部栏 -->
        <el-header style="background-color: #fff; border-bottom: 1px solid #eee; padding: 0 20px;">
          <h1 style="margin: 0; line-height: 60px; color: #2c3e50; font-size: 20px;">AIC8800-SDIO口测试工具</h1>
        </el-header>
        
        <!-- 主内容区域 -->
        <el-main style="padding: 20px;">
          <!-- 状态信息 -->
          <el-alert
            :title="info"
            type="info"
            show-icon
            :closable="false"
            style="margin-bottom: 20px;"
          ></el-alert>
          
          <!-- 配置信息面板（包含配置信息和读取文件） -->
          <el-card v-show="activePanel === '1'" style="margin-bottom: 20px;">
            <div slot="header" class="clearfix">
              <span>配置信息</span>
            </div>
            
            <!-- 配置信息部分 -->
            <div style="margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid #eee;">
              <h3 style="margin-bottom: 15px; color: #606266;">串口配置</h3>
              <el-form label-width="80px" label-position="left">
                <el-form-item label="串口">
                  <el-input v-model="config.Serial" placeholder="请输入串口名称，如COM12"></el-input>
                </el-form-item>
                <el-form-item label="波特率">
                  <el-input v-model="config.BaudRate" placeholder="请输入波特率，如921600"></el-input>
                </el-form-item>
                <el-form-item label="数据位">
                  <el-select v-model="config.DataBits" placeholder="请选择数据位">
                    <el-option label="5" value="5"></el-option>
                    <el-option label="6" value="6"></el-option>
                    <el-option label="7" value="7"></el-option>
                    <el-option label="8" value="8"></el-option>
                  </el-select>
                </el-form-item>
                <el-form-item label="停止位">
                  <el-select v-model="config.StopBits" placeholder="请选择停止位">
                    <el-option label="1" value="1"></el-option>
                    <el-option label="1.5" value="1.5"></el-option>
                    <el-option label="2" value="2"></el-option>
                  </el-select>
                </el-form-item>
                <el-form-item label="校验位">
                  <el-select v-model="config.Parity" placeholder="请选择校验位">
                    <el-option label="None" value="None"></el-option>
                    <el-option label="Odd" value="Odd"></el-option>
                    <el-option label="Even" value="Even"></el-option>
                    <el-option label="Mark" value="Mark"></el-option>
                    <el-option label="Space" value="Space"></el-option>
                  </el-select>
                </el-form-item>
                <el-form-item label="固件文件">
                  <el-input v-model="config.Bin" placeholder="请输入固件文件名，如testmode20_2023_0718_1234.bin"></el-input>
                </el-form-item>
                <el-form-item label="测试指令">
                  <el-input v-model="config.TestOrders" placeholder="请输入测试指令文件名，如TestOrders.txt"></el-input>
                </el-form-item>
              </el-form>
            </div>
            
            <!-- 读取文件部分 -->
            <div>
              <h3 style="margin-bottom: 15px; color: #606266;">读取配置文件</h3>
              <div style="margin-bottom: 20px;">
                <el-button 
                  type="primary" 
                  @click="readFile" 
                  :loading="readLoading"
                  title="读取配置文件"
                >
                  读取文件
                </el-button>
                <el-button 
                  type="success" 
                  @click="saveFile" 
                  :loading="saveLoading"
                  :disabled="!canSave"
                  title="保存配置文件"
                >
                  保存文件
                </el-button>
              </div>
              <el-scrollbar class="log-area">
                <pre :class="readError ? 'error-text' : ''">{{ readResult }}</pre>
              </el-scrollbar>
            </div>
          </el-card>
          
          <!-- 下载固件面板 -->
          <el-card v-show="activePanel === '2'" style="margin-bottom: 20px;">
            <div slot="header" class="clearfix">
              <span>下载固件</span>
            </div>
            <el-button 
              type="success" 
              @click="downloadFireWare" 
              :loading="downloadLoading"
              title="下载固件到设备"
              style="margin-bottom: 20px;"
            >
              下载固件
            </el-button>
            <el-scrollbar class="log-area">
              <pre :class="downloadError ? 'error-text' : ''">{{ downloadResult }}</pre>
            </el-scrollbar>
          </el-card>
          
          <!-- SDIO测试面板（包含测试指令和测试结果） -->
          <el-card v-show="activePanel === '3'" style="margin-bottom: 20px;">
            <div slot="header" class="clearfix">
              <span>SDIO测试</span>
            </div>
            
            <!-- 测试指令部分 -->
            <div style="margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid #eee;">
              <h3 style="margin-bottom: 15px; color: #606266;">执行测试指令</h3>
              <el-button 
                type="warning" 
                @click="testOrders" 
                :loading="testLoading"
                title="执行测试指令"
                style="margin-bottom: 20px;"
              >
                测试指令
              </el-button>
              <el-scrollbar class="log-area">
                <pre :class="testError ? 'error-text' : ''">{{ testResult }}</pre>
              </el-scrollbar>
            </div>
            
            <!-- 测试结果部分 -->
            <div>
              <h3 style="margin-bottom: 15px; color: #606266;">测试结果</h3>
              <el-button 
                type="info" 
                @click="showTestResult" 
                :disabled="!testButtonVisible"
                :class="testResultPass ? 'success-text' : 'error-text'"
                title="查看测试结果"
                style="margin-bottom: 20px;"
              >
                {{ testResultPass ? '测试通过' : '测试失败' }}
              </el-button>
              <div v-if="testResult" class="log-area" style="padding: 10px; background: #f5f7fa; border-radius: 4px;">
                <pre :class="testError ? 'error-text' : 'success-text'">测试结果：{{ testResultPass ? '通过' : '失败' }}
{{ testResult }}</pre>
              </div>
              <div v-else style="color: #909399; padding: 20px; text-align: center;">暂无测试结果</div>
            </div>
          </el-card>
          
          <!-- 重置面板（包含清除日志） -->
          <el-card v-show="activePanel === '4'" style="margin-bottom: 20px;">
            <div slot="header" class="clearfix">
              <span>重置</span>
            </div>
            <el-button 
              type="danger" 
              @click="clearLogs"
              title="清除所有日志"
              style="margin-bottom: 20px;"
            >
              清除日志
            </el-button>
            <div style="color: #606266; padding: 20px; background: #f5f7fa; border-radius: 4px;">
              点击上方按钮可清除所有功能模块的执行日志
            </div>
          </el-card>
        </el-main>
      </el-container>
    </el-container>
  </div>

  <!-- 引入外部渲染进程脚本 -->
  <script src="./renderer.js"></script>
</body>
</html>